---
import "../styles/index.css";

import { getCollection } from "astro:content";
import { name, openGraph } from "spectre:globals";
import Card from "../components/Card.astro";
import Icon from "../components/Icon.astro";
import Layout from "../layouts/Layout.astro";

const [posts] = await Promise.all([
	getCollection("posts", (post) => post.data.draft !== true),
]);
---

<Layout
	title={openGraph.home.title || name}
	description={openGraph.home.description}
	pagefindIgnore
>
	<div class="layout-grid-right" slot="right">
		<Card>
			<div class="header-container">
				<Icon
					type="lucide"
					name="rss"
					width={24}
					height={24}
					class="glow-icon"
				/>
				<h2>Latest Posts</h2>
			</div>
			<div class="content-container">
				{
					posts
						.sort(
							(a, b) =>
								b.data.createdAt.getTime() -
								a.data.createdAt.getTime(),
						)
						.slice(0, 2)
						.map((post) => (
							<a href={`/blog/${post.id}`} class="post-container">
								<div class="post-header">
									<h3>{post.data.title}</h3>
									<span class="post-date">
										{post.data.createdAt.toLocaleDateString()}
									</span>
								</div>
								<span>{post.data.description}</span>
							</a>
						))
				}
			</div>
		</Card>
	</div>
</Layout>
